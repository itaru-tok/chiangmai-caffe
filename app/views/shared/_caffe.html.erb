<div class="container">
  <h1 class="text-center mt-4">Caffe list</h1>
  <div class="row">
    <% @caffes.each do |caffe|  %>
      <div class="col-md-3 col-6">
        <div class="card mb-4 shadow-sm">
          <div class="card-body">
            <a href="/caffes/<%= caffe.id %>">
              <div class="card-img-top"><%= image_tag caffe.image.url %></div>
              <p class="card-text">
                <p class="card-text"><%= caffe.name %></p>
                <p class="card-text"><%= truncate(caffe.comment, length:50)  %></p>
              </p>
            </a>
            <p id="caffe-<%= caffe.id %>">
              <% if caffe.liked_by?(current_user) %>
                <%= render "caffes/like", caffe: caffe %>
              <% else %>
                <%= render "caffes/dislike", caffe: caffe %>
              <% end %>
            </p>
            <% if user_signed_in? and caffe.user == current_user %>
              <td><%= link_to "Delete", caffe_path(caffe), class: "btn btn-outline-danger", method: :delete ,data: { confirm: "Are you sure?"} %></td>
              <td><%= link_to "Edit", edit_caffe_path(caffe), class: "btn btn-outline-info" %></td>
            <% end %>
          </div>
          <div class="card-footer text-muted">
            <div class="index-user" >
              <% if caffe.user %>
                <%= image_tag caffe.user.avator.url, class: "index-round-img" %>
                by <%= link_to caffe.user.username, user_path(caffe.user) %><br>
              <% end %>
            </div>
            <small>Created <%= time_ago_in_words(caffe.created_at) %> ago</small>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
